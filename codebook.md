# Code Book

## Study Design

The data used for this script were collected from the UCI Machine Learning Repository (see README for a link to data source). The downloaded folder 'UCI HAR Dataset' contains several .txt files of human activity data measured by Samsung smartphones. The script `run_analysis.R` was created to perform the following operations on the downloaded data:

1. Merge the training and the test sets to create one data set.
2. Extract only the measurements on the mean and standard deviation for each measurement.
3. Use descriptive activity names to name the activities in the data set.
4. Appropriately label the data set with descriptive variable names.
5. From the data set in step 4, create a second, independent tidy data set with the average of each variable for each activity and each subject.

## Data Summary 

A summary of the raw data is provided in the 'README.txt' file from the source data.

## Data files from 'UCI HAR Dataset' used for analysis

#### Specific information about the .txt files below is provided in the 'README.txt' file from the source data.

* 'features.txt': list of all measured variables (or features)
* 'activity_labels.txt': links class labels contained in 'y_train.txt' and 'y_test.txt' with their corresponding activity names
* 'train/X_train.txt': training data set
* 'train/y_train.txt': training data activity class labels
* 'train/subject_train.txt': training data subject list
* 'test/X_test.txt': test data set
* 'test/y_test.txt': test data activity class labels
* 'test/subject_test.txt': test data subject list

## List of raw data variables

#### The following is a list of measured variables contained in the 'X_test.txt' and 'X_train.txt' files. Specific information about the measured variables is provided in the 'features_info.txt' file from the source data.

These signals were used to estimate variables of the feature vector for each pattern: '-XYZ' is used to denote 3-axial signals in the X, Y and Z directions.

* tBodyAcc-XYZ
* tGravityAcc-XYZ
* tBodyAccJerk-XYZ
* tBodyGyro-XYZ
* tBodyGyroJerk-XYZ
* tBodyAccMag
* tGravityAccMag
* tBodyAccJerkMag
* tBodyGyroMag
* tBodyGyroJerkMag
* fBodyAcc-XYZ
* fBodyAccJerk-XYZ
* fBodyGyro-XYZ
* fBodyAccMag
* fBodyAccJerkMag
* fBodyGyroMag
* fBodyGyroJerkMag

The set of variables that were estimated from these signals are: 

* mean(): Mean value
* std(): Standard deviation
* mad(): Median absolute deviation 
* max(): Largest value in array
* min(): Smallest value in array
* sma(): Signal magnitude area
* energy(): Energy measure. Sum of the squares divided by the number of values. 
* iqr(): Interquartile range 
* entropy(): Signal entropy
* arCoeff(): Autorregresion coefficients with Burg order equal to 4
* correlation(): correlation coefficient between two signals
* maxInds(): index of the frequency component with largest magnitude
* meanFreq(): Weighted average of the frequency components to obtain a mean frequency
* skewness(): skewness of the frequency domain signal 
* kurtosis(): kurtosis of the frequency domain signal 
* bandsEnergy(): Energy of a frequency interval within the 64 bins of the FFT of each window.
* angle(): Angle between to vectors.

## Summary of operations performed by 'run_analysis.R'

### Download data

This script creates a sub directory called 'project data' in the current working directory, then downloads the data from https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip and extracts the file 'UCI HAR Dataset' to the created directory.

### 1. Merge the training and the test sets to create one data set.

The script first reads each of the .txt files listed above into 8 separate objects called `featureNames`, `activityNames`, `activityTest`, `activityTrain`, `subjectTest`, `subjectTrain`, `featuresTest` and `featuresTrain` using the `read.table()` function.

Activity labels, subject data, and features data for train and test data were combined into 3 objects called `activity`, `subject` and `features` using the `rbind()` function. Each object contains combined data from both train and test files.

The data contained in each object were given a name using the `names()` function:

* `activity` (1-column data frame) was headed with the name 'activity'
* `subject` (1-column data frame) was headed with the name 'subject'
* `features` (561-column data frame) was headed with the feature names given in `featureNames`

A single 563-column data frame called `data` was created by combining the above objects using the `cbind()` function

### 2. Extract only the measurements on the mean and standard deviation for each measurement.

The `grep()` function was used to create a list of column numbers in `data` containing the string 'mean'. This list was stored as a new object called `meanCols`. The same was performed to create an object called `stdCols`, which is a list of column numbers containing the string 'std'. These two objects were combined into a single sorted list of column numbers called `cols`.

A new data frame called `msData` was created by subsetting `data` to the columns specified in `cols`; the columns corresponding to 'activity' and 'subject' (1 and 2) were also added to `msData`.

### 3. Use descriptive activity names to name the activities in the data set.

A factorized list of activity names was created called `actNames`. A new data frame called `msData2` was created using the `mutate()` function with the `dplyr` package. This line of code takes the class label ('1', '2', '3', '4', '5' or '6') listed in the 'activity' column of `msData` and inserts the descriptive name associated with that class label, which is given in `actNames`.

### 4. Appropriately label the data set with descriptive variable names.

The `names()` function was used to change the column headings of `msData2` to more descriptive variable names. The `gsub()` function was employed to make the following substitutions:

* '_' for '-'
* '' for '()'
* 'Magnitude' for 'Mag'
* 'Accelerometer' for 'Acc'
* 'Gyroscope' for 'Gyro'
* 'Frequency' for 'Freq'
* 'Body' for 'BodyBody'
* 'time' for 't'
* 'frequency' for 'f'

### 5. From the data set in step 4, create a second, independent tidy data set with the average of each variable for each activity and each subject.

The mean of each variable in `msData2` was evaluated on the basis of 'subject' and 'activity' using the `aggregate()` function and stored as a new object called `avgData`

A file called 'tidydata.txt' is written as output to the current working directory using the `write.table()` function with `avgData` as input.

Below is a summary of the tidy dataset `avgData` returned by `str(avgData)`.

'data.frame':    180 obs. of  81 variables:
 $ subject                                              : int  1 2 3 4 5 6 7 8 9 10 ...
 $ activity                                             : Factor w/ 6 levels "LAYING","SITTING",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ timeBodyAccelerometer_mean_X                         : num  0.222 0.281 0.276 0.264 0.278 ...
 $ timeBodyAccelerometer_mean_Y                         : num  -0.0405 -0.0182 -0.019 -0.015 -0.0183 ...
 $ timeBodyAccelerometer_mean_Z                         : num  -0.113 -0.107 -0.101 -0.111 -0.108 ...
 $ timeBodyAccelerometer_std_X                          : num  -0.928 -0.974 -0.983 -0.954 -0.966 ...
 $ timeBodyAccelerometer_std_Y                          : num  -0.837 -0.98 -0.962 -0.942 -0.969 ...
 $ timeBodyAccelerometer_std_Z                          : num  -0.826 -0.984 -0.964 -0.963 -0.969 ...
 $ timeGravityAccelerometer_mean_X                      : num  -0.249 -0.51 -0.242 -0.421 -0.483 ...
 $ timeGravityAccelerometer_mean_Y                      : num  0.706 0.753 0.837 0.915 0.955 ...
 $ timeGravityAccelerometer_mean_Z                      : num  0.446 0.647 0.489 0.342 0.264 ...
 $ timeGravityAccelerometer_std_X                       : num  -0.897 -0.959 -0.983 -0.921 -0.946 ...
 $ timeGravityAccelerometer_std_Y                       : num  -0.908 -0.988 -0.981 -0.97 -0.986 ...
 $ timeGravityAccelerometer_std_Z                       : num  -0.852 -0.984 -0.965 -0.976 -0.977 ...
 $ timeBodyAccelerometerJerk_mean_X                     : num  0.0811 0.0826 0.077 0.0934 0.0848 ...
 $ timeBodyAccelerometerJerk_mean_Y                     : num  0.00384 0.01225 0.0138 0.00693 0.00747 ...
 $ timeBodyAccelerometerJerk_mean_Z                     : num  0.01083 -0.0018 -0.00436 -0.00641 -0.00304 ...
 $ timeBodyAccelerometerJerk_std_X                      : num  -0.958 -0.986 -0.981 -0.978 -0.983 ...
 $ timeBodyAccelerometerJerk_std_Y                      : num  -0.924 -0.983 -0.969 -0.942 -0.965 ...
 $ timeBodyAccelerometerJerk_std_Z                      : num  -0.955 -0.988 -0.982 -0.979 -0.985 ...
 $ timeBodyGyroscope_mean_X                             : num  -0.01655 -0.01848 -0.02082 -0.00923 -0.02189 ...
 $ timeBodyGyroscope_mean_Y                             : num  -0.0645 -0.1118 -0.0719 -0.093 -0.0799 ...
 $ timeBodyGyroscope_mean_Z                             : num  0.149 0.145 0.138 0.17 0.16 ...
 $ timeBodyGyroscope_std_X                              : num  -0.874 -0.988 -0.975 -0.973 -0.979 ...
 $ timeBodyGyroscope_std_Y                              : num  -0.951 -0.982 -0.977 -0.961 -0.977 ...
 $ timeBodyGyroscope_std_Z                              : num  -0.908 -0.96 -0.964 -0.962 -0.961 ...
 $ timeBodyGyroscopeJerk_mean_X                         : num  -0.107 -0.102 -0.1 -0.105 -0.102 ...
 $ timeBodyGyroscopeJerk_mean_Y                         : num  -0.0415 -0.0359 -0.039 -0.0381 -0.0404 ...
 $ timeBodyGyroscopeJerk_mean_Z                         : num  -0.0741 -0.0702 -0.0687 -0.0712 -0.0708 ...
 $ timeBodyGyroscopeJerk_std_X                          : num  -0.919 -0.993 -0.98 -0.975 -0.983 ...
 $ timeBodyGyroscopeJerk_std_Y                          : num  -0.968 -0.99 -0.987 -0.987 -0.984 ...
 $ timeBodyGyroscopeJerk_std_Z                          : num  -0.958 -0.988 -0.983 -0.984 -0.99 ...
 $ timeBodyAccelerometerMagnitude_mean                  : num  -0.842 -0.977 -0.973 -0.955 -0.967 ...
 $ timeBodyAccelerometerMagnitude_std                   : num  -0.795 -0.973 -0.964 -0.931 -0.959 ...
 $ timeGravityAccelerometerMagnitude_mean               : num  -0.842 -0.977 -0.973 -0.955 -0.967 ...
 $ timeGravityAccelerometerMagnitude_std                : num  -0.795 -0.973 -0.964 -0.931 -0.959 ...
 $ timeBodyAccelerometerJerkMagnitude_mean              : num  -0.954 -0.988 -0.979 -0.97 -0.98 ...
 $ timeBodyAccelerometerJerkMagnitude_std               : num  -0.928 -0.986 -0.976 -0.961 -0.977 ...
 $ timeBodyGyroscopeMagnitude_mean                      : num  -0.875 -0.95 -0.952 -0.93 -0.947 ...
 $ timeBodyGyroscopeMagnitude_std                       : num  -0.819 -0.961 -0.954 -0.947 -0.958 ...
 $ timeBodyGyroscopeJerkMagnitude_mean                  : num  -0.963 -0.992 -0.987 -0.985 -0.986 ...
 $ timeBodyGyroscopeJerkMagnitude_std                   : num  -0.936 -0.99 -0.983 -0.983 -0.984 ...
 $ frequencyBodyAccelerometer_mean_X                    : num  -0.939 -0.977 -0.981 -0.959 -0.969 ...
 $ frequencyBodyAccelerometer_mean_Y                    : num  -0.867 -0.98 -0.961 -0.939 -0.965 ...
 $ frequencyBodyAccelerometer_mean_Z                    : num  -0.883 -0.984 -0.968 -0.968 -0.977 ...
 $ frequencyBodyAccelerometer_std_X                     : num  -0.924 -0.973 -0.984 -0.952 -0.965 ...
 $ frequencyBodyAccelerometer_std_Y                     : num  -0.834 -0.981 -0.964 -0.946 -0.973 ...
 $ frequencyBodyAccelerometer_std_Z                     : num  -0.813 -0.985 -0.963 -0.962 -0.966 ...
 $ frequencyBodyAccelerometer_meanFrequency_X           : num  -0.159 -0.146 -0.074 -0.274 -0.136 ...
 $ frequencyBodyAccelerometer_meanFrequency_Y           : num  0.0975 0.2573 0.2385 0.3662 0.4665 ...
 $ frequencyBodyAccelerometer_meanFrequency_Z           : num  0.0894 0.4025 0.217 0.2013 0.1323 ...
 $ frequencyBodyAccelerometerJerk_mean_X                : num  -0.957 -0.986 -0.981 -0.979 -0.983 ...
 $ frequencyBodyAccelerometerJerk_mean_Y                : num  -0.922 -0.983 -0.969 -0.944 -0.965 ...
 $ frequencyBodyAccelerometerJerk_mean_Z                : num  -0.948 -0.986 -0.979 -0.975 -0.983 ...
 $ frequencyBodyAccelerometerJerk_std_X                 : num  -0.964 -0.987 -0.983 -0.98 -0.986 ...
 $ frequencyBodyAccelerometerJerk_std_Y                 : num  -0.932 -0.985 -0.971 -0.944 -0.966 ...
 $ frequencyBodyAccelerometerJerk_std_Z                 : num  -0.961 -0.989 -0.984 -0.98 -0.986 ...
 $ frequencyBodyAccelerometerJerk_meanFrequency_X       : num  0.132 0.16 0.176 0.182 0.24 ...
 $ frequencyBodyAccelerometerJerk_meanFrequency_Y       : num  0.0245 0.1212 -0.0132 0.0987 0.1957 ...
 $ frequencyBodyAccelerometerJerk_meanFrequency_Z       : num  0.0244 0.1906 0.0448 0.077 0.0917 ...
 $ frequencyBodyGyroscope_mean_X                        : num  -0.85 -0.986 -0.97 -0.967 -0.976 ...
 $ frequencyBodyGyroscope_mean_Y                        : num  -0.952 -0.983 -0.978 -0.972 -0.978 ...
 $ frequencyBodyGyroscope_mean_Z                        : num  -0.909 -0.963 -0.962 -0.961 -0.963 ...
 $ frequencyBodyGyroscope_std_X                         : num  -0.882 -0.989 -0.976 -0.975 -0.981 ...
 $ frequencyBodyGyroscope_std_Y                         : num  -0.951 -0.982 -0.977 -0.956 -0.977 ...
 $ frequencyBodyGyroscope_std_Z                         : num  -0.917 -0.963 -0.967 -0.966 -0.963 ...
 $ frequencyBodyGyroscope_meanFrequency_X               : num  -0.00355 0.10261 -0.08222 -0.06609 -0.02272 ...
 $ frequencyBodyGyroscope_meanFrequency_Y               : num  -0.0915 0.0423 -0.0267 -0.5269 0.0681 ...
 $ frequencyBodyGyroscope_meanFrequency_Z               : num  0.0105 0.0553 0.1477 0.1529 0.0414 ...
 $ frequencyBodyAccelerometerMagnitude_mean             : num  -0.862 -0.975 -0.966 -0.939 -0.962 ...
 $ frequencyBodyAccelerometerMagnitude_std              : num  -0.798 -0.975 -0.968 -0.937 -0.963 ...
 $ frequencyBodyAccelerometerMagnitude_meanFrequency    : num  0.0864 0.2663 0.237 0.2417 0.292 ...
 $ frequencyBodyAccelerometerJerkMagnitude_mean         : num  -0.933 -0.985 -0.976 -0.962 -0.977 ...
 $ frequencyBodyAccelerometerJerkMagnitude_std          : num  -0.922 -0.985 -0.975 -0.958 -0.976 ...
 $ frequencyBodyAccelerometerJerkMagnitude_meanFrequency: num  0.266 0.342 0.239 0.274 0.197 ...
 $ frequencyBodyGyroscopeMagnitude_mean                 : num  -0.862 -0.972 -0.965 -0.962 -0.968 ...
 $ frequencyBodyGyroscopeMagnitude_std                  : num  -0.824 -0.961 -0.955 -0.947 -0.959 ...
 $ frequencyBodyGyroscopeMagnitude_meanFrequency        : num  -0.1398 0.0186 -0.0229 -0.2599 0.1024 ...
 $ frequencyBodyGyroscopeJerkMagnitude_mean             : num  -0.942 -0.99 -0.984 -0.984 -0.985 ...
 $ frequencyBodyGyroscopeJerkMagnitude_std              : num  -0.933 -0.989 -0.983 -0.983 -0.983 ...
 $ frequencyBodyGyroscopeJerkMagnitude_meanFrequency    : num  0.1765 0.2648 0.1107 0.2029 0.0247 ...
